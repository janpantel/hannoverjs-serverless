service: hjs-serverless

provider:
  name: aws
  runtime: nodejs4.3
  stage: dev
  region: eu-west-1

functions:
  hello:
    handler: handler.hello

resources:
    Resources:
        MeetupsTable:
          Type: AWS::DynamoDB::Table
          Properties:
            TableName: meetups
            AttributeDefinitions:
              - AttributeName: id
                AttributeType: S
            KeySchema:
              - AttributeName: id
                KeyType: HASH
            ProvisionedThroughput:
              ReadCapacityUnits: 1
              WriteCapacityUnits: 1
        MeetupsTableIAMPolicy:
          Type: AWS::IAM::Policy
          DependsOn: MeetupsTable
          Properties:
            PolicyName: meetups-table-lambda-dynamodb
            PolicyDocument:
              Version: '2012-10-17'
              Statement:
                - Effect: Allow
                  Action:
                    - dynamodb:GetItem
                    - dynamodb:PutItem
                    - dynamodb:Scan
                  Resource: arn:aws:dynamodb:*:*:table/meetups
            Roles:
                - Ref: IamRoleLambdaExecution
